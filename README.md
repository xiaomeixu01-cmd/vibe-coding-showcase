# Excel文件拆分工具

## 功能说明

本工具可以将一个较大的Excel文件（.xlsx格式）按每1000行拆分为多个小的Excel文件，方便处理和管理大量数据。

## 特性

- ✅ 支持.xlsx格式的Excel文件
- ✅ 保留原始文件的表头
- ✅ 自动命名拆分后的文件
- ✅ 支持中文路径
- ✅ 包含详细的错误处理
- ✅ 显示拆分进度和结果

## 安装依赖

本脚本使用了`openpyxl`库来处理Excel文件，需要先安装：

1. 打开命令提示符（Win+R输入cmd回车）
2. 运行以下命令：

```bash
pip install openpyxl
```

## 使用方法

### 1. 修改文件路径

1. 用文本编辑器（如记事本）打开`excel_splitter.py`文件
2. 找到以下代码行：

```python
excel_file = r"e:\00我的项目\00工具\Trae\脚本项目\excel-chaifen\data.xlsx"
```

3. 将路径修改为你要拆分的Excel文件的实际路径，例如：

```python
excel_file = r"C:\Users\用户名\Desktop\需要拆分的文件.xlsx"
```

**注意**：路径前面的`r`不能省略，它表示原始字符串，这样路径中的反斜杠就不需要转义了。

### 2. 运行脚本

1. 打开命令提示符
2. 切换到脚本所在的目录，例如：

```bash
cd e:\00我的项目\00工具\Trae\脚本项目\excel-chaifen
```

3. 运行脚本：

```bash
python excel_splitter.py
```

### 3. 查看结果

拆分后的文件会保存在与原文件相同的文件夹中，命名格式为：`原文件名-序号.xlsx`。

例如，原文件名为`data.xlsx`，拆分后会生成：
- data-1.xlsx
- data-2.xlsx
- ...

## 自定义拆分行数

如果需要修改每个文件的行数，可以修改脚本中的`rows_per_file`参数：

```python
split_excel_file(excel_file, rows_per_file=500)  # 改为每个文件500行
```

## 常见问题

### 1. 运行脚本时提示"No module named 'openpyxl'"

这表示你还没有安装openpyxl库，请按照上面的说明安装。

### 2. 脚本提示"文件不存在"

请检查你修改的文件路径是否正确，确保文件确实存在于该路径。

### 3. 脚本提示"仅支持.xlsx格式的Excel文件"

本脚本仅支持.xlsx格式，如果你的文件是.xls格式，可以先在Excel中另存为.xlsx格式。

### 4. 脚本提示"文件行数不足，无需拆分"

这表示你的Excel文件行数少于或等于设定的拆分行数（默认1000行），无需拆分。

## 示例

假设你有一个名为`销售数据.xlsx`的文件，包含3500行数据，运行脚本后会生成：
- 销售数据-1.xlsx（包含第1-1000行数据）
- 销售数据-2.xlsx（包含第1001-2000行数据）
- 销售数据-3.xlsx（包含第2001-3000行数据）
- 销售数据-4.xlsx（包含第3001-3500行数据）

每个文件都会保留原始文件的表头。
